---
title: 原神的伤害计算
date: 2022-02-11 02:49:16
tags:
	原神
categories:
	笔记
top_img:
	/images/posts/Genshin-damage/critical.png
cover:
	/images/posts/Genshin-damage/critical.png
---

# 前言

最近工作牵扯到伤害计算流程，正好对原神的伤害计算进行一个拆的解，毕竟没有借鉴就没有进步嘛。

此篇也正是作为原神解析系列的第一篇，尽可能地少牵扯其他不必要的系统。

# 公式

直接进行一个公式的贴：

**攻击力×技能倍率×（1+伤害加成百分比）×怪物抗性减免百分比×怪物防御减免百分比×（1+暴击伤害百分比）×（1+元素精通增幅百分比）**

> 游戏内测阶段据说是存在等级压制减伤的，不过后来公测的时候在1.5版本左右删掉了，故这里不做记录，有兴趣者可自行查阅

# 乘区

乘区的含义为公式中一个单独的乘数，由上述公式可以看出该游戏计算方式为**不同乘区内加算不同乘区外乘算**，这是**计算的前提，伤害控制的基准**。

## 攻击力乘区

攻击力可以分为基础攻击力和额外攻击力，面板上显示的其实是总攻击力，计算公式为基础攻击力＋基础攻击力×（1+额外攻击力百分比）+固定额外攻击力。

![attack](/images/posts/Genshin-damage/attack.png)


常说的**白字**其实就是指基础攻击力，基础攻击力**只与** *等级和武器攻击力* 有关。其余的所有攻击力来源都视为额外攻击力以**绿字**呈现，其中包括但不限于：圣遗物大小攻击、武器攻击百分比词条、攻击类食物、班尼特大招。

## 倍率乘区

直接写在天赋面板上的数字，目前**只与** *技能等级* 相关。不过后续这里涉及到一个**伤害值**的概念，后面会讲到。

![magnification](/images/posts/Genshin-damage/magnification.png)

## 加伤乘区

本游戏最多的乘区，来源众多，包括但不限于：圣遗物杯子主属性、圣遗物套装效果、武器特效、角色天赋、药剂、深渊场地效果。需要注意的是全伤和元素伤害是加算的关系。

需要额外补充的是，敌人身上的易伤和自身的加伤是加算的关系，这也是开服“半部讨龙真君-莫娜”的由来。

![damage-bonus](/images/posts/Genshin-damage/damage-bonus.png)

## 抗性乘区

不同的怪物抗性有所不同，这里直接引用别人测的结果。

这个乘区最泛用的是风套的40减抗。

> 当减抗幅度超出敌人原有抗性时，超出幅度会变为伤害增幅，该效果与伤害乘区独立且逐渐递减。

![resistance](/images/posts/Genshin-damage/resistance.png)

## 防御乘区

怪物防御减免百分比的计算公式如下，其中X为减防系数

**（角色等级+100）÷【（1-X）×（怪物等级＋100）+角色等级+100】**

减防效果比较稀有，一般在命座或天赋中有出现，如雷泽4命、丽莎天赋。

![defense](/images/posts/Genshin-damage/defense.png)

## 爆伤乘区

直接看面板，值得注意的是九条的六命效果不加在面板上，因为是单独作为某种属性的爆伤，猜测可能是单独进行了一次封装而不体现在面板上。

> 面板上的爆伤计算时需要加100%

![critical-damage](/images/posts/Genshin-damage/critical-damage.png)

## 元素反应乘区

一般指的是元素精通带来的提升，另外还有一些比较少见的提升方式如莫娜2命。

![elemental-reaction](/images/posts/Genshin-damage/elemental-reaction.png)

## 独立乘区

另外还有一些独特的乘区独立于以上的计算方式，除了上述所说超过抗性的减抗可以看作是一个独立乘区外，另外比较出名的就是璃月剑仙的四命了。（至于这是不是bug那就只有程序员知道了

![independent](/images/posts/Genshin-damage/independent.png)

# 实测

实践出真知，咱们还是得亲自上手测一测才能知道。

## 测试素材

![Kamisato-Ayaka](/images/posts/Genshin-damage/Kamisato-Ayaka.png)

![talent](/images/posts/Genshin-damage/talent.png)

![skill](/images/posts/Genshin-damage/skill.png)

![enemy](/images/posts/Genshin-damage/enemy.png)

## 数据汇总

测试角色为神里绫华

**攻击力** 为 **2001**

**技能倍率** 为 **407%** 

**冰属性伤害加成** 为61.6%，另外之后计算时会加上天赋的18%，即为 **79.6%**

**暴击伤害** 为 193.3%，即计算时取 **293.3%**

测试对象为遗迹守卫

由上图可知其 **冰抗** 为 **10%**，故 **抗性乘区** 为 **90%**

代入公式 **（角色等级+100）÷【（1-X）×（怪物等级＋100）+角色等级+100】**

此处没有减防手段，X取0，最后算出 **防御乘区** 为 **50.67%**

因此处不打元素反应，并不涉及反应乘区。

据本人了解神里不存在独立乘区。

所以**理论伤害**为

2001 * 407% * 179.6% * 293.3% * 90% * 50.67% = **19563.80416722242**

## 测试结果

![no-critical](/images/posts/Genshin-damage/no-critical.png)

呃，没有关系，多试几次

![critical](/images/posts/Genshin-damage/critical.png)

**实际伤害**为**19545**

**计算误差**为 (19563-19545)/19563=**0.00920104278484895** ，不到百分之零点一的误差。

另外这里可以算多一下不暴击的情况：

**理论伤害**为

2001 * 407% * 179.6% * 90% * 50.67% = **6670.2366748116**

**计算误差**为 (6670-6662)/6670=**0.0011994002998501** ，百分之零点一刚出头的误差，可以忽略不计了。

至此论证成功。

# 分析

作为一款开放世界ARPG，原神的核心点其实是在**战斗**上，一切的设计围绕这一点展开，而战斗的核心是**元素反应**，可惜这里没有测到，~~留到下一篇~~。由于这里不想涉及太多数值，这里就简单聊一聊个人对于这个伤害计算流程的想法。

## 划分多个乘区的意义？

划分乘区从某种角度上说是提供了若干个**维度**来对角色的**强度**进行**考量**，比方说有的角色低攻击高增伤、低增伤高攻击等，可以提供更多的设计方向。除此之外可以通过对不同乘区的数值投放来整体把握强度，保证不会太偏离预期。另外上面讲倍率的时候提到**伤害值**这个概念，这里补充一下。

> 伤害值这个概念最早出现于改版钟离后的天赋，在计算中该值会加到攻击力与倍率的相乘结果中在进行后续计算，即可以吃到暴伤和加伤的效果。



## 这个伤害值有什么用呢？

游戏现在开服有一年半的时间，还没有出现过**固伤辅助**，在钟离改动后一年多里这个机制陆陆续续出现在了不少角色和武器上，而现在**伤害值**这个概念却又放在了云堇、申鹤的身上。云堇和申鹤我认为是很有说法的角色，个人认为是策划在**机制**方面的又一次新尝试。

至于为什么我看好这两个角色，他们两个可以说是目前仅有的两个固伤辅助，他们并非能打出多高的伤害，而是通过技能将自身的属性**换算**成队友的伤害来让队友打输出。

~~快进到出一个全队加攻击力、防御，申鹤云堇和前台角色一起吃到加成，直接左脚踩右脚进行一个梯云纵~~

> 这个换算可能有人难以理解，这里说明一下。已知这个伤害值是加到攻击力和倍率的相乘结果上的，那么我们是否可以简单的理解成这是一个**不是相乘而是相加的独立乘区**？答案当然是肯定的。这意味着策划已经开始准备打破当初设定的“天理”，开创新的伤害计算流程。
>
> PS：这里可以参考LOL中赵信的Q技能和诺手的W技能，效果是一样的。（诺手无限火力一刀一个小朋友的最根本原因是因为他W的伤害可以吃到爆伤加成。）

而明白了它们之间的换算关系就很好理解了，**固伤辅助可以借用他人的加伤乘区和反应乘区，变相提升了其利用率**。举个隔壁的例子就是LOL里的露露和猫咪，本身不具有多强的个人能力，但是和队友在一起时就能通过1+1让自己发挥出大于1的能力，另外更重要的是它们都是**脱手**技能！

## 脱手为什么是神？

脱手为什么是神？在绝大多数队伍切人战斗的游戏里，游戏发展到一定的程度必然会出现在**后台给予前台角色能力**的角色，这不但仅仅是原神或者隔壁的崩三，就连远到有点离谱的洛克王国和赛尔号都已经往这条路走了好一段了。

这样做的其目的之一是为了防止前台角色能力过于强大带来的**数值膨胀**失控导致玩家流失，其二是拓宽设计方向，在整体强度不会有太大变动的前提下尽可能多的设计出玩家愿意买账的角色，毕竟谁都不喜欢自己刚练的角色一下就被人盖过了，让他们抽新的角色来替换队伍中的其他人他们反而更好接受。

香菱、行秋、班尼特，讨论原神的战斗不可逾越的三座大山，其中行秋和班尼特又被玩家们称作水火双神，他们到底有着到底又怎样的力量？答案就是：脱手。

原神中最宝贵的战斗资源是**队伍的格子和站场时间**，除开一些特殊的任务流程，所有人拥有一样的四个队伍位置和一样的角色站场时间，不会说你能带多几个或者同时上场操作几个。而在战场时间有限的前提下，一个辅助角色就需要在最短的战场时间里完成自己的职责，将宝贵的时间留给主C或者其他辅助。而上述三人的技能施放时间每个人不到3秒，也就是说只需要拿出三秒的时间，他们就能凭借自己的脱手技能在后台提供源源不断地助力，变相的达成同时上场多个人。

个人认为原神中一个辅助的衡量维度有：泛用性、占用资源量、自充效率。而上述三人中行秋班尼特这水火双神几乎在三点上都做到了完美：多种场合万能挂件，出场开大即可下场，自我循环无需帮充。

个人比较好奇的点是为什么这样强度的四星能够从内测走出来，虽然我个人没有内测资格但是听说三次加起来起码也有半年了，如此存在对比其他四星角色已经是**肉眼可见的超模**，导致一年半后的现在仍然活跃在深渊。当然也有人猜测是策划故意留出的强度，我并不知晓更多内情，这里也不好评价，不过根据新角色的设计来看他们对这两货已经表露出不满了。

那么香菱又何德何能与他们并列呢？既不能自充，也需要队伍辅助打反应，甚至还有对活动范围的隐性要求。因为她具有**锁面板机制**。

> 锁面板：记录技能使用者释放技能时的属性，无论其在技能其间收到何种影响均不影响其技能效果的结果计算。
>
> 快照：每次进行技能效果的结果结算都实时的调用角色当前属性。

举一个例子大家就懂了，一个每天晚上六点到十二点开放的自助餐餐厅，每个人最多2个小时，这时一个人卡在十一点五十九分买了票进场，那么他会怎么样？一般来说他根本买不到票，因为早已停止出票，退一步就算买到票了也要走，因为别人要关门了。

把上述的自助餐餐厅看成队友提供的buff，2小时看成角色自身技能的持续时间，别的角色可能因为buff时间结束了失去了加成（吃不到了），但是香菱可以凭借自己的锁面板机制完整的将buff享受（吃完两小时）。而这一点也让香菱的地位变得不可动摇，无论是什么buff，只要能吃到1s，就一定能给你吃完。恰好这和班尼特完美契合，顺带班尼特解决了香菱在内测砍过的充能问题，于是这两人形成了牢不可破的组合。个人猜测时至今日仍**没有5星通用辅助**的出现可能是策划给这班尼特整不会了，不强别人不抽，太强就更惨，别人一起上，直接能让那些不好吃到buff的以往5星角色积灰，其后果更是不可想象。

> 当然现在已经出现了很多特定条件下的专用辅助，在特定队伍中的表现是优于班尼特的，但是其完全上位依旧没有出现。

## 废人养成机？

钟离，一个让策划首次作出妥协的角色，以一种近乎粗暴的方式平息了玩家带来的舆论，甚至导致直到现在为了针对钟离而设计出各种点名针对的怪物仍然被玩家口诛笔伐。

无缝且大额的护盾，还带有一定的减抗能力，有了这样一个角色之后玩家与怪物之间几乎失去了90%的交互，因为怪物既然打不破盾，那么为什么要躲？为什么要了解它的技能和抬手动作？

有关钟离的讨论已经够多了，我在这里只说一下我个人的看法。护盾这个东西可以看作是一个临时生命值一样的东西，设计本意是让玩家抵挡掉某些高风险的技能（关于生命值最近看到一些文章也有所感想，打算之后也整理出来，不过估计篇幅不是很长）。结果这一个全程的厚盾直接让大世界90%+的怪都破不了盾。而这就牵扯到当初把护盾和霸体绑定带来的弊端了：护盾可以有，霸体也可以有，但是两者绑在一起就不好了。当初就应该把护盾和霸体分离开，这样即使玩家拥有几乎全程无伤的护盾，但是面对一些可能造成击飞、倒地的技能仍然需要躲避，护盾最多只是队伍中不在需要治疗角色，但是与怪物的交互仍然保留一部分，至少不会像现在这样专门设计针对护盾的怪物而引来玩家群体的不满。

据说马上到来的下版本会有吸盾怪出现，看来这个一年前埋下的伏笔还没有回收，而策划与钟离的故事也还远没有结束。

# 备注

看了一眼文件建立时间，是上个月的十五号，现在是二月十一号凌晨两点半，终于把这一篇完工了，也埋下了新的坑（元素反应 和 生命值设计），希望寒假最后一点时间能多摸一点吧。

## 引用

[[心得交流] 原神伤害数值计算与机制](https://bbs.nga.cn/read.php?tid=23435445)

[怪物抗性一览](https://wiki.biligame.com/ys/?curid=7656)

## 致谢名单

小宝

~~我老婆~~神里绫华



<!-- more -->

---

The story is not over.

